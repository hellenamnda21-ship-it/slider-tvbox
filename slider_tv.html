<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<title>Slider TV Box</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body,html{height:100%;overflow:hidden;background:#000;font-family:Arial;}

.slide-wrap{
    position:fixed;
    inset:0;
    z-index:1;
}

.deslizar{
    position:absolute;
    inset:0;
    background-size:cover;
    background-position:center;
    opacity:0;
    transition:opacity 1s;
}

.mostrar{opacity:1;}

#tabelaBox{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    background:rgba(0,0,0,0.65);
    color:#fff;
    padding:15px;
    display:none;
    z-index:5;
}

table{
    width:100%;
    font-size:28px;
}

th, td{
    padding:8px;
}

#btnTabela{
    position:fixed;
    top:15px;
    right:15px;
    z-index:10;
    background:#d83434;
    color:#fff;
    border:none;
    padding:10px 20px;
    font-size:20px;
    border-radius:6px;
}
</style>
</head>

<body>

<button id="btnTabela">Mostrar Tabela</button>

<div class="slide-wrap" id="slidesContainer"></div>

<div id="tabelaBox">
    <table id="tabelaMenu"></table>
</div>

<script>
// CONFIGURAÇÃO DO FIREBASE
const firebaseConfig = {
    databaseURL: "https://slider-tvbox-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ----- SLIDES -----
db.ref("slides").on("value", snap => {
    const data = snap.val();
    const container = document.getElementById("slidesContainer");
    container.innerHTML = "";

    const urls = Object.values(data).filter(v => typeof v === "string");

    urls.forEach(url => {
        let div = document.createElement("div");
        div.className = "deslizar";
        div.style.backgroundImage = `url('${url}')`;
        container.appendChild(div);
    });

    iniciarSlider();
});

let indice = 0;
function iniciarSlider(){
    const slides = document.querySelectorAll(".deslizar");
    if(slides.length === 0) return;

    setInterval(()=>{
        slides.forEach(s => s.classList.remove("mostrar"));
        slides[indice].classList.add("mostrar");
        indice = (indice + 1) % slides.length;
    }, 5000);
}

// ----- TABELA -----
db.ref("menuData/1").on("value", snap => {
    const dados = snap.val();
    const tabela = document.getElementById("tabelaMenu");

    tabela.innerHTML = "<tr><th>Produto</th><th>Preço</th></tr>";

    Object.values(dados).forEach(item => {
        tabela.innerHTML += `
            <tr>
                <td>${item[0]}</td>
                <td>${item[1]}</td>
            </tr>
        `;
    });
});

// BOTÃO MOSTRAR / OCULTAR
const tabelaBox = document.getElementById("tabelaBox");
const btnTabela = document.getElementById("btnTabela");

btnTabela.onclick = () => {
    if(tabelaBox.style.display === "none"){
        tabelaBox.style.display = "block";
        btnTabela.innerText = "Ocultar Tabela";
    } else {
        tabelaBox.style.display = "none";
        btnTabela.innerText = "Mostrar Tabela";
    }
};
</script>

</body>
</html>
